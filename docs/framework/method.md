# 方法

## 基础调用

本方法并非HTTP接口，而是指DLL方法，通过调用DLL方法来获取底层框架数据

#### 链接库

|DLL|入口函数|说明|
|:---------------|:-----|:---------------|
|bin\drea.dll|CallApi|调用通用函数|

#### 请求结构

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|appId|string|是|应用ID|
|method|string|是|请求方法|
|params|string|是|请求参数，JSON格式|

#### 返回结构

JSON格式

|字段|类型|说明|
|:---------------|:-----|:---------------|
|isSuccess|int|是否成功，0：否，1：是|
|message|string|返回信息|
|data|object|返回数据|

#### 示例伪代码
这里我们以调用`码_艾特`方法为例
```js
var result = CallApi("cc.drea.demo", "Code_At",{
    "id": "123456"
})

print result
{
    "isSuccess": 1,
    "message": "调用成功",
    "data": {
        "content": "[DR:at,id=123456]"
    }
}
```

## 码_艾特

#### 请求方法

|方法|说明|
|:---------------|:---------------|
|Code_At||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|id|string|是|用户号，传`all`时，则表示艾特全体成员|

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|content|string|[艾特码](./code.md#艾特码)|


## 码_表情

|方法|说明|
|:---------------|:---------------|
|Code_Emoji||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|id|string|是|[表情ID](./const.md#表情id)|
|type|int|否|[表情类型](./const.md#表情类型)|

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|content|string|[表情码](./code.md#表情码)|


## 码_图片

|方法|说明|
|:---------------|:---------------|
|Code_Image||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|file|string|是|文件路径，本地路径 / 网址|
|width|long|否|图片宽度|
|height|long|否|图片高度|

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|content|string|[图片码](./code.md#图片码)|


## 码_视频

|方法|说明|
|:---------------|:---------------|
|Code_Video||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|file|string|是|文件路径，本地路径 / 网址|
|duration|long|否|视频时长|
|size|long|否|视频大小|

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|content|string|[视频码](./code.md#视频码)|


## 码_文件

|方法|说明|
|:---------------|:---------------|
|Code_File||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|file|string|是|文件路径，本地路径 / 网址|
|name|string|否|文件名称|
|size|long|否|文件大小|

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|content|string|[文件码](./code.md#文件码)|


## 码_语音

|方法|说明|
|:---------------|:---------------|
|Code_Record||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|file|string|是|文件路径，本地路径 / 网址|

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|content|string|[语音码](./code.md#语音码)|


## 码_音乐

|方法|说明|
|:---------------|:---------------|
|Code_Music||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|id|string|是|音乐ID|
|type|string|否|[音乐类型](./const.md#音乐类型)|

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|content|string|[音乐码](./code.md#音乐码)|


## 码_卡片

|方法|说明|
|:---------------|:---------------|
|Code_Card||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|type|string|是|[卡片类型](./const.md#卡片类型)|
|title|string|是|标题|
|content|string|是|内容|
|image|string|是|图片|
|url|string|是|链接|

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|content|string|[卡片码](./code.md#卡片码)|


## 码_转义

|方法|说明|
|:---------------|:---------------|
|Code_Encode||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|data|string|是|数据|

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|content|string|转义后的数据|


## 码_反转义

|方法|说明|
|:---------------|:---------------|
|Code_Decode||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|data|string|是|数据|

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|content|string|反转义后的数据|


## 取机器人配置

|方法|说明|
|:---------------|:---------------|
|GetBotOptions||

#### 请求参数

无

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|clientId|string|唯一标识|


## 取机器人信息

|方法|说明|
|:---------------|:---------------|
|GetBotInfo||

#### 请求参数

无

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|clientId|string|唯一标识|
|userId|string|用户号|
|nickName|string|昵称|
|avatarUrl|string|头像|


## 置机器人群退出

|方法|说明|
|:---------------|:---------------|
|SetBotIslandLeave||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|islandId|string|是|群号|

#### 返回数据

无


## 取群列表

|方法|说明|
|:---------------|:---------------|
|GetIslandList||

#### 请求参数

无

#### 返回列表

|字段|类型|说明|
|:---------------|:-----|:---------------|
|islandId|string|群号|
|islandName|string|群名称|
|coverUrl|string|群头像|
|description|string|群描述|
|memberCount|int|群人数|
|defaultChannelId|string|默认进入频道|
|systemChannelId|string|系统消息频道|


## 取群信息

|方法|说明|
|:---------------|:---------------|
|GetIslandInfo||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|islandId|string|是|群号|

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|islandId|string|群号|
|islandName|string|群名称|
|coverUrl|string|群头像|
|description|string|群描述|
|memberCount|int|群人数|
|defaultChannelId|string|默认进入频道|
|systemChannelId|string|系统消息频道|


## 置群禁言

|方法|说明|
|:---------------|:---------------|
|SetIslandBan||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|islandId|string|是|群号|
|duration|int|是|禁言时长，为0时解禁|

#### 返回数据

无


## 取频道列表

|方法|说明|
|:---------------|:---------------|
|GetChannelList||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|islandId|string|是|群号|

#### 返回列表

|字段|类型|说明|
|:---------------|:-----|:---------------|
|channelId|string|频道号|
|channelName|string|频道名称|
|channelType|int|[频道类型](./const.md#频道类型)|
|groupId|string|分组ID|
|groupName|string|分组名称|


## 取频道信息

|方法|说明|
|:---------------|:---------------|
|GetChannelInfo||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|channelId|string|是|频道号|

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|channelId|string|频道号|
|channelName|string|频道名称|
|channelType|int|[频道类型](./const.md#频道类型)|
|groupId|string|分组ID|
|groupName|string|分组名称|


## 置频道消息发送

:::tip
由于适配了多平台，因此此接口进行了抽象

对于CQ，群 即 CQ群，频道 即 CQ群，置频道消息发送 即 置群消息发送

对于Q频，群 即 QQ频道，频道 即 QQ子频道

对于DoDo，群 即 DoDo群，频道 即 DoDo频道
:::

|方法|说明|
|:---------------|:---------------|
|SetChannelMessageSend||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|channelId|string|是|频道号，对于CQ，虽然频道号和群号值相同，但是也请传频道号，否则无法适配多平台|
|messageBody|string|是|消息内容|
|replyMessageId|string|否|回复消息ID，不传会被当成主动消息而受到限制|

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|messageId|string|消息ID|


## 置频道消息撤回

|方法|说明|
|:---------------|:---------------|
|SetChannelMessageWithdraw||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|channelId|string|是|频道号|
|messageId|string|是|消息ID|
|reason|string|是|撤回原因|

#### 返回数据

无


## 取成员列表

|方法|说明|
|:---------------|:---------------|
|GetMemberList||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|islandId|string|群号|

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|userId|string|用户号|
|nickName|string|昵称|
|avatarUrl|string|头像|
|islandNickName|string|群昵称|
|joinTime|string|加群时间|
|role|int|[角色](./const.md#角色类型)|
|sex|int|[性别](./const.md#性别类型)|
|level|int|等级|


## 取成员信息

|方法|说明|
|:---------------|:---------------|
|GetMemberInfo||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|islandId|string|是|群号|
|userId|string|是|用户号|

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|userId|string|用户号|
|nickName|string|昵称|
|avatarUrl|string|头像|
|islandNickName|string|群昵称|
|joinTime|string|加群时间|
|role|int|[角色](./const.md#角色类型)|
|sex|int|[性别](./const.md#性别类型)|
|level|int|等级|


## 置成员昵称

|方法|说明|
|:---------------|:---------------|
|SetMemberNick||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|islandId|string|是|群号|
|userId|string|是|用户号|
|nickName|string|是|在群昵称|

#### 返回数据

无


## 置成员禁言

|方法|说明|
|:---------------|:---------------|
|SetMemberBan||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|islandId|string|是|群号|
|userId|string|是|用户号|
|duration|int|是|禁言时长|
|reason|string|否|禁言原因|

#### 返回数据

无


## 置成员移除

|方法|说明|
|:---------------|:---------------|
|SetMemberRemove||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|islandId|string|是|群号|
|userId|string|是|用户号|
|duration|int|否|是否拉黑，0：否，1：是|

#### 返回数据

无


## 置成员加入审批

|方法|说明|
|:---------------|:---------------|
|SetMemberJoinApproval||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|applyType|string|是|[申请类型](./const.md#申请类型)|
|applyId|string|是|申请标识|
|approvalType|string|是|[审批类型](./const.md#审批类型)|
|approvalReason|string|否|审批理由|

#### 返回数据

无


## 置个人消息发送

|方法|说明|
|:---------------|:---------------|
|SetPersonalMessageSend||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|islandId|string|否|群号，某些平台要求必填|
|userId|string|是|用户号|
|messageBody|string|是|消息内容|
|replyMessageId|否|string|回复消息ID，不传会被当成主动消息而受到限制|

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|content|string|反转义码|


## 置个人添加审批

|方法|说明|
|:---------------|:---------------|
|SetPersonalAddApproval||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|applyId|string|是|申请标识|
|approvalType|string|是|[审批类型](./const.md#审批类型)|
|approvalReason|string|否|审批理由|

#### 返回数据

无


## 置日志发送

|方法|说明|
|:---------------|:---------------|
|SetLogSend||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|content|string|是|内容|
|type|string|否|[类型](./const.md#日志类型)|

#### 返回数据

无


## 置应用签名

|方法|说明|
|:---------------|:---------------|
|SetAppSign||

#### 请求参数

|字段|类型|是否必传|说明|
|:---------------|:-----|:-----|:---------------|
|params|json|是|待签名数据|

#### 返回数据

|字段|类型|说明|
|:---------------|:-----|:---------------|
|content|string|签名后数据|